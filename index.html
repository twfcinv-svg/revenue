<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç‡Ÿæ”¶äº’å‹•å„€éŒ¶æ¿ï½œä¾›æ‡‰éˆæœˆç‡Ÿæ”¶ç†±åŠ›åœ–ï¼ˆè¨ºæ–·ç‰ˆï¼‰</title>
  <script>
    const VER = new URLSearchParams(location.search).get('v') || Date.now();
    document.write('<link rel="stylesheet" href="styles.css?v='+VER+'">');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    body { margin: 0; }
    .page-title { 
      margin: 16px 16px 8px; 
      font-weight: 700; 
      /* å¤§æ–¼ h2ï¼ˆé€šå¸¸ 24pxï¼‰ï¼Œé€™è£¡è¨­ 30px */
      font-size: 30px; 
      line-height: 1.25; 
      color: #fff;
    }
    .controls { margin: 8px 16px 12px; }
    .layout { margin: 0 16px 24px; }
  </style>
</head>
<body>
  <!-- æ–°å¢çš„é é¢å¤§æ¨™é¡Œï¼Œä½æ–¼è¼¸å…¥å€‹è‚¡æ¬„ä½ä¸Šæ–¹ -->
  <h1 class="page-title">ç‡Ÿæ”¶äº’å‹•å„€éŒ¶æ¿</h1>

  <section class="controls">
    <div class="field">
      <label for="stockInput">è‚¡ç¥¨ä»£è™Ÿ / åç¨±</label>
      <input id="stockInput" type="text" placeholder="ä¾‹å¦‚ï¼š2330 æˆ– å°ç©é›»" />
    </div>
    <div class="field">
      <label for="monthSelect">æœˆä»½</label>
      <select id="monthSelect"></select>
    </div>
    <div class="field">
      <label for="metricSelect">æŒ‡æ¨™</label>
      <select id="metricSelect">
        <option value="YoY">å¹´æˆé•· (YoY)</option>
        <option value="MoM">æœˆè®Šå‹• (MoM)</option>
      </select>
    </div>
    <button id="runBtn" class="primary">æŸ¥è©¢</button>
    <div id="resultChip" class="result-chip" aria-live="polite"></div>
    <span id="status" class="status" style="margin-left:8px"></span>
  </section>

  <main class="layout">
    <section class="column" id="upstreamCol">
      <div class="section-head">
        <h2>ä¸Šæ¸¸ç”¢æ¥­</h2>
        <div class="legend">
          <span class="chip pos-chip">è¡¨ç¾ä½³</span>
          <span class="chip neu-chip">ä¸­æ€§</span>
          <span class="chip neg-chip">è¡¨ç¾å¼±</span>
        </div>
      </div>
      <div class="treemap-wrap"><svg id="upTreemap"></svg></div>
      <div id="upHint" class="meta" style="margin-top:6px"></div>
    </section>

    <section class="column" id="downstreamCol">
      <div class="section-head">
        <h2>ä¸‹æ¸¸ç”¢æ¥­</h2>
        <div class="legend">
          <span class="chip pos-chip">è¡¨ç¾ä½³</span>
          <span class="chip neu-chip">ä¸­æ€§</span>
          <span class="chip neg-chip">è¡¨ç¾å¼±</span>
        </div>
      </div>
      <div class="treemap-wrap"><svg id="downTreemap"></svg></div>
      <div id="downHint" class="meta" style="margin-top:6px"></div>
    </section>
  
<!-- === ç”¢æ¥­ä¾›æ‡‰éˆï¼ˆäº’å‹•å¿ƒæ™ºåœ–ï¼‰å€å¡Š === -->
<section id="supplychain" class="column" style="margin: 0 16px 48px;">
  <div class="section-head">
    <h2>åŠå°é«”ç”¢æ¥­ä¾›æ‡‰éˆï¼ˆäº’å‹•å¿ƒæ™ºåœ–ï¼‰</h2>
  </div>
  <div id="supplychain-vis" style="width:100%; max-width:1100px; margin:auto;"></div>
  <div id="supplychain-stock-list" class="meta" style="margin-top:10px;">
    ğŸ” é»æ“Šä¸Šæ–¹ç¯€é»æŸ¥çœ‹è©²æ­¥é©Ÿçš„å€‹è‚¡â€¦
  </div>
</section>

<script>
  document.write('<script src="assets/js/supplychain.js?v='+VER+'"><\/script>');
</script>

</main>

  <script>
    document.write('<script src="app.js?v='+VER+'"><\/script>');
    document.write('<script src="stock-link-plugin.js?v='+VER+'"><\/script>');
    document.write('<script src="app_query_link_B.js?v='+VER+'"><\/script>');
  </script>
</body>
</html>
