<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ç‡Ÿæ”¶äº’å‹•å„€éŒ¶æ¿ï½œä¾›æ‡‰éˆæœˆç‡Ÿæ”¶ç†±åŠ›åœ–ï¼ˆè¨ºæ–·ç‰ˆï¼‰</title>
  <script>
    const VER = new URLSearchParams(location.search).get('v') || Date.now();
    document.write('<link rel="stylesheet" href="styles.css?v='+VER+'">');
  </script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  <style>
    body { margin: 0; }
    .page-title { 
      margin: 16px 16px 8px; 
      font-weight: 700; 
      /* å¤§æ–¼ h2ï¼ˆé€šå¸¸ 24pxï¼‰ï¼Œé€™è£¡è¨­ 30px */
      font-size: 30px; 
      line-height: 1.25; 
      color: #fff;
    }
    .controls { margin: 8px 16px 12px; }
    .layout { margin: 0 16px 24px; }
  </style>
</head>
<body>
  <!-- æ–°å¢çš„é é¢å¤§æ¨™é¡Œï¼Œä½æ–¼è¼¸å…¥å€‹è‚¡æ¬„ä½ä¸Šæ–¹ -->
  <h1 class="page-title">ç‡Ÿæ”¶äº’å‹•å„€éŒ¶æ¿</h1>

  <section class="controls">
    <div class="field">
      <label for="stockInput">è‚¡ç¥¨ä»£è™Ÿ / åç¨±</label>
      <input id="stockInput" type="text" placeholder="ä¾‹å¦‚ï¼š2330 æˆ– å°ç©é›»" />
    </div>
    <div class="field">
      <label for="monthSelect">æœˆä»½</label>
      <select id="monthSelect"></select>
    </div>
    <div class="field">
      <label for="metricSelect">æŒ‡æ¨™</label>
      <select id="metricSelect">
        <option value="YoY">å¹´æˆé•· (YoY)</option>
        <option value="MoM">æœˆè®Šå‹• (MoM)</option>
      </select>
    </div>
    <button id="runBtn" class="primary">æŸ¥è©¢</button>
    <div id="resultChip" class="result-chip" aria-live="polite"></div>
    <span id="status" class="status" style="margin-left:8px"></span>
  </section>

  <main class="layout">
    <section class="column" id="upstreamCol">
      <div class="section-head">
        <h2>ä¸Šæ¸¸ç”¢æ¥­</h2>
        <div class="legend">
          <span class="chip pos-chip">è¡¨ç¾ä½³</span>
          <span class="chip neu-chip">ä¸­æ€§</span>
          <span class="chip neg-chip">è¡¨ç¾å¼±</span>
        </div>
      </div>
      <div class="treemap-wrap"><svg id="upTreemap"></svg></div>
      <div id="upHint" class="meta" style="margin-top:6px"></div>
    </section>

    <section class="column" id="downstreamCol">
      <div class="section-head">
        <h2>ä¸‹æ¸¸ç”¢æ¥­</h2>
        <div class="legend">
          <span class="chip pos-chip">è¡¨ç¾ä½³</span>
          <span class="chip neu-chip">ä¸­æ€§</span>
          <span class="chip neg-chip">è¡¨ç¾å¼±</span>
        </div>
      </div>
      <div class="treemap-wrap"><svg id="downTreemap"></svg></div>
      <div id="downHint" class="meta" style="margin-top:6px"></div>
    </section>
  
<section id="supplychain" class="column" style="margin: 0 16px 48px;">
  <div class="section-head"><h2>åŠå°é«”ç”¢æ¥­ä¾›æ‡‰éˆï¼ˆäº’å‹•å¿ƒæ™ºåœ–ï¼‰</h2></div>
  <div id="supplychain-vis" style="width:100%;max-width:1100px;margin:auto;"></div>
  <div id="supplychain-stock-list" class="meta" style="margin-top:10px;">ğŸ” é»æ“Šç¯€é»æŸ¥çœ‹è©²æ­¥é©Ÿçš„å€‹è‚¡â€¦</div>
</section>
<script>document.write('<script src="supplychain.js?v='+VER+'"><\/script>');</script>


<!-- === ç”¢æ¥­ä¾›æ‡‰éˆï¼ˆæµç¨‹ï¼‹å¯é»ç¯€é»ï¼‰ === -->
<section id="sc-section" style="margin: 24px 16px 48px;">
  <h2 style="margin:0 0 12px;">ç”¢æ¥­éˆæµç¨‹ & æ¦‚å¿µè‚¡ï¼ˆäº’å‹•ï¼‰</h2>
  <div id="sc-grid">
    <aside id="sc-left">
      <div id="sc-list-title">ğŸ“Œ è«‹å…ˆé»å³æ–¹ç¯€é»ï¼ˆä¾‹å¦‚ï¼šICå°è£ï¼‰</div>
      <ul id="sc-stock-list"></ul>
    </aside>
    <div id="sc-right">
      <svg id="sc-svg" viewBox="0 0 1000 620" preserveAspectRatio="xMidYMid meet"></svg>
    </div>
  </div>
</section>
<style>
  #sc-grid{ display:grid; grid-template-columns: 360px 1fr; gap:16px; }
  @media (max-width: 900px){ #sc-grid{ grid-template-columns: 1fr; } }
  #sc-left{ background:rgba(15,23,42,.4); border:1px solid rgba(255,255,255,.08); border-radius:8px; padding:12px; min-height: 200px; color:#e5e7eb; }
  #sc-list-title{ font-weight:700; margin-bottom:8px; }
  #sc-stock-list{ list-style:none; margin:0; padding:0;}
  #sc-stock-list li{ padding:8px 6px; border-bottom:1px dashed rgba(255,255,255,.12); display:flex; align-items:center; gap:8px;}
  #sc-stock-list .code{ font-weight:700; color:#fff; min-width:56px; }
  #sc-stock-list .chip{ font-size:12px; padding:2px 6px; border-radius:999px; background:rgba(255,255,255,.12)}
  #sc-stock-list li button{ margin-left:auto; padding:4px 8px; font-size:12px; border:1px solid rgba(255,255,255,.18); background:transparent; color:#e5e7eb; border-radius:6px; cursor:pointer; }
  #sc-right{ background:rgba(15,23,42,.4); border:1px solid rgba(255,255,255,.08); border-radius:8px; padding:10px; }
  .sc-link{ stroke:#bdbdbd; stroke-width:1.5px; marker-end:url(#sc-arrow); }
  .sc-node circle{ fill:#ff8a8a; stroke:#cc6666; stroke-width:1.5px; cursor:pointer; }
  .sc-node text{ fill:#e5e7eb; font-size:13px; pointer-events:none; }
  .sc-node.highlight circle{ fill:#e74c3c; stroke:#b60e0e; stroke-width:3px; }
</style>
<script>
  (function(){ var VER = new URLSearchParams(location.search).get('v')||Date.now();
    document.write('<script src="supplychain.js?v='+VER+'">\x3C/script>');
  })();
</script>

</main>

  <script>
    document.write('<script src="app.js?v='+VER+'"><\/script>');
    document.write('<script src="stock-link-plugin.js?v='+VER+'"><\/script>');
    document.write('<script src="app_query_link_B.js?v='+VER+'"><\/script>');
  </script>
</body>
</html>
